!function(e){function t(t){for(var o,r,a=t[0],c=t[1],l=t[2],d=0,p=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(u&&u(t);p.length;)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(o=!1)}o&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={2:0},s=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;s.push([11,0]),n()}([,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),i=n(0);class s extends o.Component{constructor(e){super(e);const t=()=>this.props.maxCountdownTime?this.props.maxCountdownTime():i.default.config.skipNoticeDuration;this.countdownInterval=null,this.amountOfPreviousNotices=e.amountOfPreviousNotices||0,this.idSuffix=e.idSuffix||"",this.state={noticeTitle:e.noticeTitle,maxCountdownTime:t,countdownTime:t(),countdownText:null,countdownManuallyPaused:!1}}componentDidMount(){this.startCountdown()}render(){var e;const t=Object.assign({zIndex:this.props.zIndex||1e3+this.amountOfPreviousNotices},null!==(e=this.props.style)&&void 0!==e?e:{});return o.createElement("table",{id:"sponsorSkipNotice"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNotice"+(this.props.fadeIn?" sponsorSkipNoticeFadeIn":"")+(this.amountOfPreviousNotices>0?" secondSkipNotice":""),style:t,onMouseEnter:()=>this.timerMouseEnter(),onMouseLeave:()=>this.timerMouseLeave()},o.createElement("tbody",null,o.createElement("tr",{id:"sponsorSkipNoticeFirstRow"+this.idSuffix},o.createElement("td",null,o.createElement("img",{id:"sponsorSkipLogo"+this.idSuffix,className:"sponsorSkipLogo sponsorSkipObject",src:chrome.extension.getURL("icons/IconSponsorBlocker256px.png")}),o.createElement("span",{id:"sponsorSkipMessage"+this.idSuffix,style:{float:"left"},className:"sponsorSkipMessage sponsorSkipObject"},this.state.noticeTitle)),o.createElement("td",{className:"sponsorSkipNoticeRightSection",style:{top:"11px"}},this.props.timed?o.createElement("span",{id:"sponsorSkipNoticeTimeLeft"+this.idSuffix,onClick:()=>this.toggleManualPause(),className:"sponsorSkipObject sponsorSkipNoticeTimeLeft"},this.state.countdownText||this.state.countdownTime+"s"):"",o.createElement("img",{src:chrome.extension.getURL("icons/close.png"),className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeCloseButton sponsorSkipNoticeRightButton",onClick:()=>this.close()}))),this.props.children))}timerMouseEnter(){this.state.countdownManuallyPaused||this.pauseCountdown()}timerMouseLeave(){this.state.countdownManuallyPaused||this.startCountdown()}toggleManualPause(){this.setState({countdownManuallyPaused:!this.state.countdownManuallyPaused},()=>{this.state.countdownManuallyPaused?this.pauseCountdown():this.startCountdown()})}countdown(){if(!this.props.timed)return;const e=Math.min(this.state.countdownTime-1,this.state.maxCountdownTime());if(this.props.videoSpeed&&this.intervalVideoSpeed!=this.props.videoSpeed()&&this.setupInterval(),e<=0)return clearInterval(this.countdownInterval),void this.close();if(3==e){const e=document.getElementById("sponsorSkipNotice"+this.idSuffix);e.style.removeProperty("animation"),e.classList.add("sponsorSkipNoticeFadeOut")}this.setState({countdownTime:e})}removeFadeAnimation(){const e=document.getElementById("sponsorSkipNotice"+this.idSuffix);e.classList.remove("sponsorSkipNoticeFadeOut"),e.style.animation="none"}pauseCountdown(){this.props.timed&&(this.countdownInterval&&clearInterval(this.countdownInterval),this.countdownInterval=null,this.setState({countdownTime:this.state.maxCountdownTime(),countdownText:this.state.countdownManuallyPaused?chrome.i18n.getMessage("manualPaused"):chrome.i18n.getMessage("paused")}),this.removeFadeAnimation())}startCountdown(){this.props.timed&&null===this.countdownInterval&&(this.setState({countdownTime:this.state.maxCountdownTime(),countdownText:null}),this.setupInterval())}setupInterval(){this.countdownInterval&&clearInterval(this.countdownInterval);const e=this.props.videoSpeed?1e3/this.props.videoSpeed():1e3;this.countdownInterval=setInterval(this.countdown.bind(this),e),this.props.videoSpeed&&(this.intervalVideoSpeed=this.props.videoSpeed())}resetCountdown(){this.props.timed&&(this.setupInterval(),this.setState({countdownTime:this.state.maxCountdownTime(),countdownText:null}),this.removeFadeAnimation())}close(e){null!==this.countdownInterval&&clearInterval(this.countdownInterval),e||this.props.closeListener()}changeNoticeTitle(e){this.setState({noticeTitle:e})}addNoticeInfoMessage(e,t=""){const n=document.getElementById("sponsorTimesInfoMessage"+this.idSuffix);null!=n&&document.getElementById("sponsorSkipNotice"+this.idSuffix).removeChild(n);const o=document.getElementById("sponsorTimesInfoMessage"+this.idSuffix+"2");null!=o&&document.getElementById("sponsorSkipNotice"+this.idSuffix).removeChild(o);const i=document.createElement("p");if(i.id="sponsorTimesInfoMessage"+this.idSuffix,i.className="sponsorTimesInfoMessage",i.innerText=e,document.querySelector("#sponsorSkipNotice"+this.idSuffix+" > tbody").insertBefore(i,document.getElementById("sponsorSkipNoticeSpacer"+this.idSuffix)),void 0!==t){const e=document.createElement("p");e.id="sponsorTimesInfoMessage"+this.idSuffix+"2",e.className="sponsorTimesInfoMessage",e.innerText=t,document.querySelector("#sponsorSkipNotice"+this.idSuffix+" > tbody").insertBefore(e,document.getElementById("sponsorSkipNoticeSpacer"+this.idSuffix))}}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1);class i extends o.Component{constructor(e){super(e)}render(){const e={};return this.props.onClick&&(e.cursor="pointer",e.textDecoration="underline"),o.createElement("p",{id:"sponsorTimesInfoMessage"+this.props.idSuffix,onClick:this.props.onClick,style:e,className:"sponsorTimesInfoMessage"},this.props.text)}}t.default=i},,,function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(0),s=n(4),r=new(n(2).default),a=n(9),c=n(12),l=n(13),u=n(19);r.wait(()=>null!==i.default.config,5e3,10).then((function(){!r.isFirefox()&&i.default.config.invidiousInstances.includes(new URL(document.URL).host)&&window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementsByTagName("head")[0];for(const t of r.css){const n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.href=chrome.extension.getURL(t),e.appendChild(n)}})}));let d=!1,p=null,m=null;const h=[];let g,f,v=null,y=null,S=[],T=null;const k=[],b=[];let C,w,x,E=null,N=!1,M=0,I=-1,B=!1,L=null,U=null;const O={};r.wait(()=>null!==i.default.config,1e3,1).then(()=>q($(document.URL))),document.addEventListener("keydown",Ee);let D=0,R=[],P=!1,V=null,A=!1;const j=()=>({vote:Te,dontShowNoticeAgain:ke,unskipSponsorTime:se,sponsorTimes:p,sponsorTimesSubmitting:R,skipNotices:h,v:f,sponsorVideoID:m,reskipSponsorTime:re,updatePreviewBar:ee,onMobileYouTube:w,sponsorSubmissionNotice:V,resetSponsorSubmissionNotice:be,updateEditButtonsOnPlayer:de,previewTime:oe,videoInfo:v,getRealCurrentTime:pe});function _(e,t,n){return o(this,void 0,void 0,(function*(){switch(e.message){case"update":q($(document.URL));break;case"sponsorStart":me(),n({creatingSegment:ge()});break;case"isInfoFound":n({found:d,sponsorTimes:p}),P&&null!=document.getElementById("sponsorBlockPopupContainer")&&ye(),P=!0;break;case"getVideoID":n({videoID:m,creatingSegment:ge()});break;case"getChannelID":n({channelID:g.id});break;case"isChannelWhitelisted":n({value:B});break;case"whitelistChange":B=e.value,X(m);break;case"submitTimes":Ce();break;case"refreshSegments":yield X(m,!1),n({})}}))}function F(e){for(const t in e)switch(t){case"hideVideoPlayerControls":case"hideInfoButtonPlayerControls":case"hideDeleteButtonPlayerControls":ue()}}function q(e){return o(this,void 0,void 0,(function*(){if(m!==e&&(m=e,function(){M=0,I=-1,p=null,D=0,S=[],v=null,B=!1,g={status:s.ChannelIDStatus.Fetching,id:null},null!==L&&L.clear(),d=!1,E=null!==E,N=!0,A=!1;for(let e=0;e<h.length;e++)h.pop().close()}(),e)){if(yield r.wait(()=>null!==i.default.config,5e3,1),i.default.config.checkForUnlistedVideos){if(!confirm("SponsorBlock: You have the setting 'Ignore Unlisted/Private Videos' enabled. Due to a change in how segment fetching works, this setting is not needed anymore as it cannot leak your video ID to the server. It instead sends just the first 4 characters of a longer hash of the videoID to the server, and filters through a subset of the database. More info about this implementation can be found here: https://github.com/ajayyy/SponsorBlockServer/issues/25\n\nPlease click okay to confirm that you acknowledge this and continue using SponsorBlock."))return;i.default.config.checkForUnlistedVideos=!1}if(function(){o(this,void 0,void 0,(function*(){const e=yield r.asyncRequestToCustomServer("GET","https://www.youtube.com/get_video_info?video_id="+m+"&html5=1&c=TVHTML5&cver=7.20190319");if(e.ok){const t=decodeURIComponent(e.responseText).match(/player_response=([^&]*)/)[1];if(!t)return console.error("[SB] Failed at getting video info from YouTube."),void console.error("[SB] Data returned from YouTube: "+e.responseText);v=JSON.parse(t)}}))}(),function(){o(this,void 0,void 0,(function*(){const e=i.default.config.whitelistedChannels,t=()=>{var e,t,n,o,i,s,r,a,c,l,u;return null!==(a=null!==(i=null!==(t=null===(e=null==v?void 0:v.videoDetails)||void 0===e?void 0:e.channelId)&&void 0!==t?t:null===(o=null===(n=document.querySelector(".ytd-channel-name a"))||void 0===n?void 0:n.getAttribute("href"))||void 0===o?void 0:o.replace(/\/.+\//,""))&&void 0!==i?i:null===(r=null===(s=document.querySelector(".ytp-title-channel-logo"))||void 0===s?void 0:s.getAttribute("href"))||void 0===r?void 0:r.replace(/https:\/.+\//,""))&&void 0!==a?a:null===(u=null===(l=null===(c=document.querySelector("a > .channel-profile"))||void 0===c?void 0:c.parentElement)||void 0===l?void 0:l.getAttribute("href"))||void 0===u?void 0:u.replace(/\/.+\//,"")};try{yield r.wait(()=>!!t(),6e3,20),g={status:s.ChannelIDStatus.Found,id:t().match(/^\/?([^\s/]+)/)[0]}}catch(e){return void(g={status:s.ChannelIDStatus.Failed,id:null})}null!=e&&g.status===s.ChannelIDStatus.Found&&e.includes(g.id)&&(B=!0),i.default.config.forceChannelCheck&&(null==p?void 0:p.length)>0&&Z()}))}(),null===L)if(w){const e=new MutationObserver(H);let t=null;r.wait(()=>(t=document.getElementById("player-control-container"),null!==t)).then(()=>{e.observe(document.getElementById("player-control-container"),{attributes:!0,childList:!0,subtree:!0})}).catch()}else r.wait(ce).then(W);ye(),X(e),ue(),R=[],fe()}}))}function H(){if(ue(),null!==L){if(document.body.contains(L.container)){const t=document.querySelector(".progress-bar-background");return void(null!==t&&(e=t,null===document.getElementById("previewbar")&&L.createElement(e)))}L.remove(),L=null}var e;W()}function W(){if(null!==L)return;const e=[".progress-bar-background",".ytp-progress-bar-container",".no-model.cue-range-markers",".vjs-progress-holder"];for(const t of e){const e=document.querySelector(t);if(e){L=new c.default(e,w,C),ee();break}}}function Y(){Ne(),ee()}function G(){null!==y&&(clearTimeout(y),y=null)}function J(e=!1,t,n=!0){var o;if(G(),A)return I=-1,void(M=0);if(!f||f.paused)return;if(i.default.config.disableSkipping||B||g.status===s.ChannelIDStatus.Fetching&&i.default.config.forceChannelCheck)return;if(z())return;null==t&&(t=f.currentTime);const a=function(e,t,n){const o=ne(p,t,n),i=ne(p,t,n,e,!0,!0),s=o.indexOf(Math.min(...i)),r=te(p,s),a=ne(R,t,n),c=ne(R,t,n,e,!1,!1),l=a.indexOf(Math.min(...c)),u=te(R,l);return-1===l&&-1!==s||o[s]<a[l]?{array:p,index:s,endIndex:r,openNotice:!0}:{array:R,index:l,endIndex:u,openNotice:!1}}(t,e,n);if(-1===a.index)return;const c=a.array[a.index],u=[c.segment[0],a.array[a.endIndex].segment[1]],d=u[0]-t,v=m;let S=[a.array[a.index]];if(a.index!==a.endIndex){S=[];for(const e of a.array)r.getCategorySelection(e.category).option===s.CategorySkipOption.AutoSkip&&e.segment[0]>=u[0]&&e.segment[1]<=u[1]&&S.push(e)}if((null===(o=r.getCategorySelection(c.category))||void 0===o?void 0:o.option)===s.CategorySkipOption.ShowOverlay&&a.array!==R)return;const T=()=>{var e;let t=null,n=!1,o=!0;z(v,c)||(f.currentTime>=u[0]&&f.currentTime<u[1]&&(!function(e,t,n,o){var a;const c=(null===(a=r.getCategorySelection(n[0].category))||void 0===a?void 0:a.option)===s.CategorySkipOption.AutoSkip;(c||R.includes(n[0]))&&e.currentTime!==t[1]&&(e.loop&&e.duration>1&&t[1]>=e.duration-1?e.currentTime=0:e.currentTime=t[1]);o&&(i.default.config.dontShowNotice&&c||h.push(new l.default(n,c,j)));c&&ie(n,t[1]-t[0],!0)}(f,u,S,a.openNotice),(null===(e=r.getCategorySelection(c.category))||void 0===e?void 0:e.option)===s.CategorySkipOption.ManualSkip?t=u[0]+.001:(t=u[1],n=!0,o=!1)),J(n,t,o))};d<=0?T():y=setTimeout(T,1e3*d*(1/f.playbackRate))}function z(e,t){const n=$(document.URL);return(n!==(e||m)||!(!t||p&&p.includes(t)||R.includes(t)))&&(console.error("[SponsorBlock] The videoID recorded when trying to skip is different than what it should be."),console.error("[SponsorBlock] VideoID recorded: "+m+". Actual VideoID: "+n),q(n),!0)}function K(){const e=document.querySelector("video");e&&e!==f&&(f=e,k.includes(f)||(k.push(f),f.addEventListener("durationchange",Y),i.default.config.disableSkipping||(E=!1,f.addEventListener("play",()=>{E=!1,(N||0!==f.currentTime)&&(N=!1,Ne(),(Math.abs(I-f.currentTime)>.3||I!==f.currentTime&&Date.now()-M>2e3)&&(M=Date.now(),I=f.currentTime,J()))}),f.addEventListener("playing",()=>{(Math.abs(I-f.currentTime)>.3||I!==f.currentTime&&Date.now()-M>2e3)&&(M=Date.now(),I=f.currentTime,J())}),f.addEventListener("seeking",()=>{f.paused||(M=Date.now(),I=f.currentTime,J())}),f.addEventListener("ratechange",()=>J()),f.addEventListener("videoSpeed_ratechange",()=>J()),f.addEventListener("pause",()=>{I=-1,M=0,G()}),J())))}function X(e,t=!0){var n,a;return o(this,void 0,void 0,(function*(){if(f||K(),!f)return void setTimeout(()=>X(e),100);!function(){const e=document.querySelector(".html5-video-container");e&&null===T&&!C&&(T=new MutationObserver(K),T.observe(e,{attributes:!0,childList:!0,subtree:!0}))}();let o=!1;const c=[];for(const e of i.default.config.categorySelections)c.push(e.name);const l=(yield r.getHash(e,1)).substr(0,4),u=yield r.asyncRequestToServer("GET","/api/skipSegments/"+l,{categories:c});if(null==u?void 0:u.ok){const o=null===(a=null===(n=JSON.parse(u.responseText))||void 0===n?void 0:n.filter(t=>t.videoID===e))||void 0===a?void 0:a.map(e=>e.segments)[0];if(!o||!o.length)return void Q();if(d=!0,null!==p&&t)for(let e=0;e<p.length;e++)p[e].source===s.SponsorSourceType.Local&&o.push(p[e]);const r=p||[];if(p=o,0!==i.default.config.minDuration)for(let e=0;e<p.length;e++)p[e].segment[1]-p[e].segment[0]<i.default.config.minDuration&&(p[e].hidden=s.SponsorHideType.MinimumDuration);if(t)for(const e of r){const t=p.find(t=>e.UUID===t.UUID);t&&(t.hidden=e.hidden,t.category=e.category)}Z(),(x==e||null==x&&!isNaN(f.duration))&&ee(),D=0}else 404===(null==u?void 0:u.status)?Q():D<15&&!o&&(o=!0,setTimeout(()=>{m&&0===(null==p?void 0:p.length)&&X(m)},5e3+15e3*Math.random()+5e3*D),D++)}))}function Q(){i.default.config.refetchWhenNotFound&&(d=!1,r.wait(()=>!!v).then(()=>{var e,t;const n=null===(t=null===(e=null==v?void 0:v.microformat)||void 0===e?void 0:e.playerMicroformatRenderer)||void 0===t?void 0:t.uploadDate;Date.now()-new Date(n).getTime()<2592e5&&setTimeout(()=>{m&&0===(null==p?void 0:p.length)&&X(m)},1e4+3e4*Math.random())}),D=0)}function Z(){if(!E){let e=-1;for(const t of p)if(t.segment[0]<=f.currentTime&&t.segment[0]>e&&t.segment[1]>f.currentTime){e=t.segment[0];break}if(-1===e)for(const t of R)if(t.segment[0]<=f.currentTime&&t.segment[0]>e&&t.segment[1]>f.currentTime){e=t.segment[0];break}-1!==e?J(void 0,e):J()}}function $(e){e.startsWith("https://www.youtube.com/tv#/")&&(e=e.replace("#",""));let t=null;try{t=new URL(e)}catch(t){return console.error("[SB] Unable to parse URL: "+e),!1}if(i.default.config&&i.default.config.invidiousInstances.includes(t.host))C=!0;else if("m.youtube.com"===t.host)w=!0;else if(!["m.youtube.com","www.youtube.com","www.youtube-nocookie.com","music.youtube.com"].includes(t.host))return i.default.config||r.wait(()=>null!==i.default.config).then(()=>q($(e))),!1;if(t.searchParams.has("v")&&["/watch","/watch/"].includes(t.pathname)||t.pathname.startsWith("/tv/watch")){const e=t.searchParams.get("v");return 11==e.length&&e}if(t.pathname.startsWith("/embed/"))try{return t.pathname.substr(7,11)}catch(t){return console.error("[SB] Video ID not valid for "+e),!1}return!1}function ee(){if(null===L)return;if(A)return void L.clear();if(null===f)return;const e=[];if(p&&p.forEach(t=>{t.hidden===s.SponsorHideType.Visible&&e.push({segment:t.segment,category:t.category,unsubmitted:!1})}),R.forEach(t=>{e.push({segment:t.segment,category:t.category,unsubmitted:!0})}),L.set(e,f.duration),i.default.config.showTimeWithSkips){!function(e){if(w||C)return;(isNaN(e)||e<0)&&(e=0);const t=document.querySelector(".ytp-time-display.notranslate");if(!t)return;let n=document.getElementById("sponsorBlockDurationAfterSkips");null===n&&(n=document.createElement("span"),n.id="sponsorBlockDurationAfterSkips",n.classList.add("ytp-time-duration"),t.appendChild(n));const o=r.getFormattedTime(f.duration-e);n.innerText=null==o||e<=0?"":" ("+o+")"}(r.getTimestampsDuration(e.map(({segment:e})=>e)))}x=m}function te(e,t,n=!0){var o;if(-1==t||(null===(o=r.getCategorySelection(e[t].category))||void 0===o?void 0:o.option)!==s.CategorySkipOption.AutoSkip)return t;let i=t;for(let t=0;t<(null==e?void 0:e.length);t++){const o=e[t].segment,a=e[i].segment[1];o[0]<=a&&o[1]>a&&(!n||e[t].hidden===s.SponsorHideType.Visible)&&r.getCategorySelection(e[t].category).option===s.CategorySkipOption.AutoSkip&&(i=t)}return i!==t&&(i=te(e,i,n)),i}function ne(e,t,n,o,i=!1,a=!1){if(null===e)return[];const c=[];for(let l=0;l<(null==e?void 0:e.length);l++)!(void 0===o||n&&e[l].segment[0]>=o||t&&e[l].segment[0]<o&&e[l].segment[1]>o)||i&&r.getCategorySelection(e[l].category).option===s.CategorySkipOption.ShowOverlay||a&&e[l].hidden!==s.SponsorHideType.Visible||c.push(e[l].segment[0]);return c}function oe(e,t=!0){f.currentTime=e,t&&f.paused&&f.play()}function ie(e,t,n){if(!i.default.config.trackViewCount||!i.default.config.trackViewCountInPrivate&&chrome.extension.inIncognitoContext)return;let o=!1;for(const s of e){const e=p.indexOf(s);-1===e||S[e]||(S[e]=!0,o||(i.default.config.minutesSaved=i.default.config.minutesSaved+t/60,i.default.config.skipCount=i.default.config.skipCount+1,o=!0),n&&r.asyncRequestToServer("POST","/api/viewedVideoSponsorTime?UUID="+s.UUID))}}function se(e){null!=p&&(f.currentTime=e.segment[0]+.001)}function re(e){const t=Math.max(e.segment[1]-f.currentTime,0),n=t/(e.segment[1]-e.segment[0])>.5;f.currentTime=e.segment[1],ie([e],t,n),J(!0,e.segment[1],!1)}function ae(e,t,n,o,i=!1){const s=document.getElementById(e+"Button");if(null!==s)return s;const r=document.createElement("button");r.draggable=i,r.id=e+"Button",r.classList.add("playerButton"),r.classList.add("ytp-button"),r.setAttribute("title",chrome.i18n.getMessage(t)),r.addEventListener("click",()=>{n()});const a=document.createElement("img");return r.draggable=i,a.id=e+"Image",a.className="playerButtonImage",a.src=chrome.extension.getURL("icons/"+o),r.appendChild(a),U&&U.prepend(r),O[e]={button:r,image:a,setupListener:!1},r}function ce(){const e=[".ytp-right-controls",".player-controls-top",".vjs-control-bar"];for(const t of e){const e=document.querySelectorAll(t);if(e&&e.length>0)return e[e.length-1]}return!1}function le(){var e;return o(this,void 0,void 0,(function*(){if(w)return;U=yield r.wait(ce).catch(),ae("startSegment","sponsorStart",()=>Se(()=>me()),"PlayerStartIconSponsorBlocker.svg"),ae("cancelSegment","sponsorCancel",()=>Se(()=>function(){ge()&&(R.splice(R.length-1,1),i.default.config.segmentTimes.set(m,R),R.length<=0&&be());de(),fe(!1)}()),"PlayerCancelSegmentIconSponsorBlocker.svg"),ae("delete","clearTimes",()=>Se(()=>function(){const e=m,t=i.default.config.segmentTimes.get(e);if(null!=t&&t.length>0){const n=chrome.i18n.getMessage("clearThis")+xe(t)+"\n"+chrome.i18n.getMessage("confirmMSG");if(!confirm(n))return;be(),i.default.config.segmentTimes.delete(e),R=[],ee(),de()}}()),"PlayerDeleteIconSponsorBlocker.svg"),ae("submit","SubmitTimes",Ce,"PlayerUploadIconSponsorBlocker.svg"),ae("info","openPopup",ve,"PlayerInfoIconSponsorBlocker.svg");const t=ce();i.default.config.autoHideInfoButton&&!C&&t&&(null===(e=O.info)||void 0===e?void 0:e.button)&&!b.includes(t)&&(b.push(t),O.info.button.classList.add("hidden"),t.addEventListener("mouseenter",()=>{O.info.button.classList.remove("hidden")}),t.addEventListener("mouseleave",()=>{O.info.button.classList.add("hidden")}))}))}function ue(){return o(this,void 0,void 0,(function*(){m&&!w&&(yield le(),de(),i.default.config.hideInfoButtonPlayerControls||document.URL.includes("/embed/")||C?O.info.button.style.display="none":O.info.button.style.removeProperty("display"))}))}function de(){if(!m||w)return;const e=!i.default.config.hideVideoPlayerControls&&!C;let t=!1,n=!1,o=!1;e&&(t=ge(),n=R.length>1||R.length>0&&!t,o=R.length>1||R.length>0&&!t),O.startSegment.button.style.display=e?"unset":"none",O.cancelSegment.button.style.display=e&&t?"unset":"none",e&&(t?(O.startSegment.image.src=chrome.extension.getURL("icons/PlayerStopIconSponsorBlocker.svg"),O.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorEnd"))):(O.startSegment.image.src=chrome.extension.getURL("icons/PlayerStartIconSponsorBlocker.svg"),O.startSegment.button.setAttribute("title",chrome.i18n.getMessage("sponsorStart")))),O.submit.button.style.display=n&&!i.default.config.hideUploadButtonPlayerControls?"unset":"none",O.delete.button.style.display=o&&!i.default.config.hideDeleteButtonPlayerControls?"unset":"none"}function pe(){var e,t;return"M 18,11 V 7 l -5,5 5,5 v -4 c 3.3,0 6,2.7 6,6 0,3.3 -2.7,6 -6,6 -3.3,0 -6,-2.7 -6,-6 h -2 c 0,4.4 3.6,8 8,8 4.4,0 8,-3.6 8,-8 0,-4.4 -3.6,-8 -8,-8 z"===(null===(t=null===(e=document.querySelector(".ytp-play-button"))||void 0===e?void 0:e.querySelector(".ytp-svg-fill"))||void 0===t?void 0:t.getAttribute("d"))?f.duration:f.currentTime}function me(){if(ge()){const e=he(),t=e.segment[0],n=pe();e.segment=[Math.min(t,n),Math.max(t,n)]}else R.push({segment:[pe()],UUID:null,category:i.default.config.defaultCategory,source:s.SponsorSourceType.Local});i.default.config.segmentTimes.set(m,R),X(m),de(),fe(!1)}function he(){return R[R.length-1]}function ge(){var e;const t=he();return t&&2!==(null===(e=null==t?void 0:t.segment)||void 0===e?void 0:e.length)}function fe(e=!0){const t=i.default.config.segmentTimes.get(m);if(e&&null!=t){R=[];for(const e of t)R.push({segment:e.segment,UUID:e.UUID,category:e.category,source:e.source})}ee(),null!==f&&J(),null!==V&&V.update()}function ve(){null==document.getElementById("sponsorBlockPopupContainer")&&(P=!1,O.info&&(O.info.button.style.display="none"),function(e,t,n){const o=new XMLHttpRequest;o.open(e,t,!0),null!=n&&(o.onreadystatechange=function(){n(o,!1)},o.onerror=function(){n(o,!0)});o.send()}("GET",chrome.extension.getURL("popup.html"),(function(e){if(4==e.readyState&&200==e.status){const t=document.createElement("div");t.id="sponsorBlockPopupContainer";let n=e.responseText;n=n.replace(/<head>[\S\s]*<\/head>/gi,""),n=n.replace(/<body/gi,"<div"),n=n.replace(/<\/body/gi,"</div"),t.innerHTML=n;const o=document.createElement("div");o.innerText=chrome.i18n.getMessage("closePopup"),o.classList.add("smallLink"),o.setAttribute("align","center"),o.addEventListener("click",ye),o.style.color="var(--yt-spec-text-primary)",t.prepend(o);const i=document.querySelectorAll("#secondary");let s=null;for(let e=0;e<i.length;e++)null!==i[e].firstElementChild&&(s=i[e]);null==s&&(s=document.getElementById("watch7-sidebar-contents"));const r=t.querySelector("#sponsorBlockPopupLogo"),c=t.querySelector("#sbPopupIconSettings"),l=t.querySelector("#sbPopupIconEdit"),u=t.querySelector("#sbPopupIconCheck"),d=t.querySelector("#refreshSegments");r.src=chrome.extension.getURL("icons/IconSponsorBlocker256px.png"),c.src=chrome.extension.getURL("icons/settings.svg"),l.src=chrome.extension.getURL("icons/pencil.svg"),u.src=chrome.extension.getURL("icons/check.svg"),d.src=chrome.extension.getURL("icons/refresh.svg"),s.insertBefore(t,s.firstChild),a.default(_)}})))}function ye(){const e=document.getElementById("sponsorBlockPopupContainer");null!==e&&(e.remove(),!document.URL.includes("/embed/")&&O.info&&(O.info.button.style.display="unset"))}function Se(e){return ye(),e()}function Te(e,t,n,o){null!=o&&(o.addVoteButtonInfo.bind(o)(chrome.i18n.getMessage("Loading")),o.setNoticeInfoMessage.bind(o)());const s=r.getSponsorIndexFromUUID(p,t);if(-1!=s&&null!==p[s].UUID){if(0===e&&S[s]||1===e&&!S[s]){let t=1;0==e&&(t=-1,S[s]=!1),i.default.config.minutesSaved=i.default.config.minutesSaved+t*(p[s].segment[1]-p[s].segment[0])/60,i.default.config.skipCount=i.default.config.skipCount+t}chrome.runtime.sendMessage({message:"submitVote",type:e,UUID:t,category:n},(function(i){null!=i&&null!=o&&(1==i.successType||-1==i.successType&&429==i.statusCode?o.afterVote.bind(o)(r.getSponsorTimeFromUUID(p,t),e,n):-1==i.successType&&(o.setNoticeInfoMessage.bind(o)(r.getErrorMessage(i.statusCode,i.responseText)),o.resetVoteButtonInfo.bind(o)()))}))}}function ke(){i.default.config.dontShowNotice=!0,function(){const e=document.getElementsByClassName("sponsorSkipNotice");for(let t=0;t<e.length;t++)e[t].remove()}()}function be(){null==V||V.close(),V=null}function Ce(){null===V&&void 0!==R&&R.length>0&&(V=new u.default(j,we))}function we(){return o(this,void 0,void 0,(function*(){O.submit.image.src=chrome.extension.getURL("icons/PlayerUploadIconSponsorBlocker.svg");const e=r.applyLoadingAnimation(O.submit.button,1,()=>de());for(let e=0;e<R.length;e++)R[e].segment[1]>f.duration&&(R[e].segment[1]=f.duration);if(i.default.config.segmentTimes.set(m,R),i.default.config.minDuration>0)for(let e=0;e<R.length;e++)if(R[e].segment[1]-R[e].segment[0]<i.default.config.minDuration){const e=chrome.i18n.getMessage("shortCheck")+"\n\n"+xe(R);if(!confirm(e))return}const t=yield r.asyncRequestToServer("POST","/api/skipSegments",{videoID:m,userID:i.default.config.userID,segments:R,videoDuration:null==f?void 0:f.duration});if(200===t.status){e(),i.default.config.segmentTimes.delete(m);const n=R;try{const e=JSON.parse(t.responseText);if((null==e?void 0:e.length)===n.length)for(let t=0;t<e.length;t++)n[t].UUID=e[t].UUID}catch(e){}p=(p||[]).concat(n),i.default.config.sponsorTimesContributed=i.default.config.sponsorTimesContributed+R.length,i.default.config.submissionCountSinceCategories=i.default.config.submissionCountSinceCategories+1,R=[],ee()}else O.submit.button.style.animation="unset",O.submit.image.src=chrome.extension.getURL("icons/PlayerUploadFailedIconSponsorBlocker.svg"),alert(r.getErrorMessage(t.status,t.responseText))}))}function xe(e){let t="";for(let n=0;n<e.length;n++)for(let o=0;o<e[n].segment.length;o++){let i=r.getFormattedTime(e[n].segment[o]);1==o?i=" to "+i:n>0&&(i=", "+i),t+=i}return t}function Ee(e){var t,n,o,s,r;if(["textarea","input"].includes(null===(n=null===(t=document.activeElement)||void 0===t?void 0:t.tagName)||void 0===n?void 0:n.toLowerCase())||(null===(r=null===(s=null===(o=document.activeElement)||void 0===o?void 0:o.id)||void 0===s?void 0:s.toLowerCase())||void 0===r?void 0:r.includes("editable")))return;const a=e.key,c=i.default.config.skipKeybind,l=i.default.config.startSponsorKeybind,u=i.default.config.submitKeybind;switch(a){case c:if(h.length>0){const e=h[h.length-1];e.toggleSkip.call(e)}break;case l:me();break;case u:Ce()}}function Ne(){const e=A;A=document.getElementsByClassName("ad-showing").length>0,e!=A&&(ee(),ue())}chrome.runtime.onMessage.addListener(_),i.default.configListeners.includes(F)||i.default.configListeners.push(F)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),i=new(n(2).default);t.default=class{constructor(e,t,n){this.segments=[],this.videoDuration=0,this.container=document.createElement("ul"),this.container.id="previewbar",this.parent=e,this.onMobileYouTube=t,this.onInvidious=n,this.createElement(e),this.setupHoverText()}setupHoverText(){if(this.onMobileYouTube||this.onInvidious)return;this.categoryTooltip=document.createElement("div"),this.categoryTooltip.className="ytp-tooltip-title sponsorCategoryTooltip";const e=document.querySelector(".ytp-tooltip-text-wrapper");if(!e||!e.parentElement)return;this.tooltipContainer=e.parentElement;const t=e.querySelector(".ytp-tooltip-title");if(!this.tooltipContainer||!t)return;e.insertBefore(this.categoryTooltip,t.nextSibling);const n=document.querySelector(".ytp-progress-bar-container");if(!n)return;let o=!1;n.addEventListener("mouseenter",()=>{o=!0}),n.addEventListener("mouseleave",()=>{o=!1}),new MutationObserver(t=>{if(!o||!this.categoryTooltip||!this.tooltipContainer)return;if(1===t.length&&t[0].target.classList.contains("sponsorCategoryTooltip"))return;const n=e.querySelectorAll(".ytp-tooltip-text");let s=null,r=!1;for(const e of n){e.classList.contains("ytp-tooltip-text-no-title")&&(r=!0);const t=e.textContent;if(null!==t&&0!==t.length&&(s=i.getFormattedTimeToSeconds(t),null!==s))break}if(null===s)return;let a=null,c=1/0;for(const e of this.segments)if(e.segment[0]<=s&&e.segment[1]>s){const t=e.segment[1]-e.segment[0];t<c&&(c=t,a=e)}null===a&&this.tooltipContainer.classList.contains("sponsorCategoryTooltipVisible")?this.tooltipContainer.classList.remove("sponsorCategoryTooltipVisible"):null!==a&&(this.tooltipContainer.classList.add("sponsorCategoryTooltipVisible"),a.unsubmitted?this.categoryTooltip.textContent=chrome.i18n.getMessage("unsubmitted")+" "+i.shortCategoryName(a.category):this.categoryTooltip.textContent=i.shortCategoryName(a.category),this.categoryTooltip.classList.toggle("ytp-tooltip-text-no-title",r))}).observe(e,{childList:!0,subtree:!0})}createElement(e){this.parent=e,this.onMobileYouTube?(e.style.backgroundColor="rgba(255, 255, 255, 0.3)",e.style.opacity="1",this.container.style.transform="none"):this.onInvidious||(this.parent.addEventListener("mouseenter",()=>this.container.classList.add("hovered")),this.parent.addEventListener("mouseleave",()=>this.container.classList.remove("hovered"))),this.parent.prepend(this.container)}clear(){for(this.videoDuration=0,this.segments=[];this.container.firstChild;)this.container.removeChild(this.container.firstChild)}set(e,t){this.clear(),e&&(this.segments=e,this.videoDuration=t,this.segments.sort(({segment:e},{segment:t})=>t[1]-t[0]-(e[1]-e[0])).forEach(e=>{const t=this.createBar(e);this.container.appendChild(t)}))}createBar({category:e,unsubmitted:t,segment:n}){var i,s;const r=document.createElement("li");r.classList.add("previewbar"),r.innerHTML="&nbsp;";const a=(t?"preview-":"")+e;return r.setAttribute("sponsorblock-category",a),r.style.backgroundColor=null===(i=o.default.config.barTypes[a])||void 0===i?void 0:i.color,this.onMobileYouTube||(r.style.opacity=null===(s=o.default.config.barTypes[a])||void 0===s?void 0:s.opacity),r.style.position="absolute",r.style.width=this.timeToPercentage(n[1]-n[0]),r.style.left=this.timeToPercentage(n[0]),r}remove(){this.container.remove(),this.categoryTooltip&&(this.categoryTooltip.remove(),this.categoryTooltip=void 0),this.tooltipContainer&&(this.tooltipContainer.classList.remove("sponsorCategoryTooltipVisible"),this.tooltipContainer=void 0)}timeToPercentage(e){return Math.min(100,e/this.videoDuration*100)+"%"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),i=n(5),s=new(n(2).default),r=n(18);t.default=class{constructor(e,t=!1,n){this.skipNoticeRef=o.createRef(),this.segments=e,this.autoSkip=t,this.contentContainer=n;const a=s.findReferenceNode(),c=document.getElementsByClassName("sponsorSkipNotice").length;let l="";for(const e of this.segments)l+=e.UUID;l+=c,this.noticeElement=document.createElement("div"),this.noticeElement.id="sponsorSkipNoticeContainer"+l,a.prepend(this.noticeElement),i.render(o.createElement(r.default,{segments:e,autoSkip:t,contentContainer:n,ref:this.skipNoticeRef,closeListener:()=>this.close()}),this.noticeElement)}close(){i.unmountComponentAtNode(this.noticeElement),this.noticeElement.remove();const e=this.contentContainer().skipNotices;e.splice(e.indexOf(this),1)}toggleSkip(){this.skipNoticeRef.current.prepAction(r.SkipNoticeAction.Unskip)}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SkipNoticeAction=void 0;const o=n(1),i=n(3),s=n(0),r=n(4),a=n(7),c=n(8);var l;!function(e){e[e.None=0]="None",e[e.Upvote=1]="Upvote",e[e.Downvote=2]="Downvote",e[e.CategoryVote=3]="CategoryVote",e[e.Unskip=4]="Unskip"}(l=t.SkipNoticeAction||(t.SkipNoticeAction={}));class u extends o.Component{constructor(e){super(e),this.noticeRef=o.createRef(),this.categoryOptionRef=o.createRef(),this.segments=e.segments,this.autoSkip=e.autoSkip,this.contentContainer=e.contentContainer,this.audio=null;const t=chrome.i18n.getMessage(this.segments.length>1?"multipleSegments":"category_"+this.segments[0].category+"_short")||chrome.i18n.getMessage("category_"+this.segments[0].category);let n=t+" "+chrome.i18n.getMessage("skipped");this.autoSkip||(n=chrome.i18n.getMessage("skip_category").replace("{0}",t)),this.amountOfPreviousNotices=document.getElementsByClassName("sponsorSkipNotice").length,this.segments.length>1&&this.segments.sort((e,t)=>e.segment[0]-t.segment[0]);for(const e of this.segments)this.idSuffix+=e.UUID;this.idSuffix+=this.amountOfPreviousNotices,this.state={noticeTitle:n,messages:[],messageOnClick:null,maxCountdownTime:()=>s.default.config.skipNoticeDuration,countdownTime:s.default.config.skipNoticeDuration,countdownText:null,unskipText:chrome.i18n.getMessage("unskip"),unskipCallback:e=>this.unskip(e),downvoting:!1,choosingCategory:!1,thanksForVotingText:null,actionState:l.None},this.autoSkip||Object.assign(this.state,this.getUnskippedModeInfo(0,chrome.i18n.getMessage("skip")))}componentDidMount(){s.default.config.audioNotificationOnSkip&&this.audio&&(this.audio.volume=.1*this.contentContainer().v.volume,this.autoSkip&&this.audio.play())}render(){const e={};return this.contentContainer().onMobileYouTube&&(e.bottom="4em",e.transform="scale(0.8) translate(10%, 10%)"),o.createElement(a.default,{noticeTitle:this.state.noticeTitle,amountOfPreviousNotices:this.amountOfPreviousNotices,idSuffix:this.idSuffix,fadeIn:!0,timed:!0,maxCountdownTime:this.state.maxCountdownTime,videoSpeed:()=>{var e;return null===(e=this.contentContainer().v)||void 0===e?void 0:e.playbackRate},style:e,ref:this.noticeRef,closeListener:()=>this.closeListener()},s.default.config.audioNotificationOnSkip&&o.createElement("audio",{ref:e=>{this.audio=e}},o.createElement("source",{src:chrome.extension.getURL("icons/beep.ogg"),type:"audio/ogg"})),this.getMessageBoxes(),o.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.idSuffix},this.state.thanksForVotingText?o.createElement("td",{id:"sponsorTimesVoteButtonInfoMessage"+this.idSuffix,className:"sponsorTimesInfoMessage sponsorTimesVoteButtonMessage",style:{marginRight:"10px"}},this.state.thanksForVotingText):o.createElement("td",{id:"sponsorTimesVoteButtonsContainer"+this.idSuffix,className:"sponsorTimesVoteButtonsContainer"},o.createElement("img",{id:"sponsorTimesDownvoteButtonsContainer"+this.idSuffix,className:"sponsorSkipObject voteButton",style:{marginRight:"10px"},src:chrome.extension.getURL("icons/thumbs_up.svg"),title:chrome.i18n.getMessage("upvoteButtonInfo"),onClick:()=>this.prepAction(l.Upvote)}),o.createElement("img",{id:"sponsorTimesDownvoteButtonsContainer"+this.idSuffix,className:"sponsorSkipObject voteButton",src:chrome.extension.getURL("icons/thumbs_down.svg"),title:chrome.i18n.getMessage("reportButtonInfo"),onClick:()=>this.adjustDownvotingState(!0)})),o.createElement("td",{className:"sponsorSkipNoticeUnskipSection"},o.createElement("button",{id:"sponsorSkipUnskipButton"+this.idSuffix,className:"sponsorSkipObject sponsorSkipNoticeButton",style:{marginLeft:"4px"},onClick:()=>this.prepAction(l.Unskip)},this.state.unskipText+" ("+s.default.config.skipKeybind+")")),this.autoSkip?o.createElement("td",{className:"sponsorSkipNoticeRightSection"},o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.contentContainer().dontShowNoticeAgain},chrome.i18n.getMessage("Hide"))):""),this.state.downvoting&&o.createElement("tr",{id:"sponsorSkipNoticeDownvoteOptionsRow"+this.idSuffix},o.createElement("td",{id:"sponsorTimesDownvoteOptionsContainer"+this.idSuffix},o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.prepAction(l.Downvote)},chrome.i18n.getMessage("downvoteDescription")),o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.openCategoryChooser()},chrome.i18n.getMessage("incorrectCategory")))),this.state.choosingCategory&&o.createElement("tr",{id:"sponsorSkipNoticeCategoryChooserRow"+this.idSuffix},o.createElement("td",null,o.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeCategories",defaultValue:this.segments[0].category,ref:this.categoryOptionRef},this.getCategoryOptions()),1===this.segments.length&&o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.prepAction(l.CategoryVote)},chrome.i18n.getMessage("submit")))),this.state.actionState!==l.None&&o.createElement("tr",{id:"sponsorSkipNoticeSubmissionOptionsRow"+this.idSuffix},o.createElement("td",{id:"sponsorTimesSubmissionOptionsContainer"+this.idSuffix},this.getSubmissionChooser())))}getSubmissionChooser(){const e=[];for(let t=0;t<this.segments.length;t++)e.push(o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton",onClick:()=>this.performAction(t),key:"submission"+t+this.segments[t].category+this.idSuffix},t+1+". "+chrome.i18n.getMessage("category_"+this.segments[t].category)));return e}prepAction(e){1===this.segments.length?this.performAction(0,e):this.setState({actionState:e})}getMessageBoxes(){if(0===this.state.messages.length)return o.createElement("tr",{id:"sponsorSkipNoticeSpacer"+this.idSuffix,className:"sponsorBlockSpacer"});const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(o.createElement(c.default,{idSuffix:this.idSuffix,text:this.state.messages[t],onClick:this.state.messageOnClick,key:t}));return e}performAction(e,t){switch(null!=t?t:this.state.actionState){case l.None:break;case l.Upvote:this.contentContainer().vote(1,this.segments[e].UUID,void 0,this);break;case l.Downvote:this.contentContainer().vote(0,this.segments[e].UUID,void 0,this);break;case l.CategoryVote:this.contentContainer().vote(void 0,this.segments[e].UUID,this.categoryOptionRef.current.value,this);break;case l.Unskip:this.state.unskipCallback(e)}this.setState({actionState:l.None})}adjustDownvotingState(e){e||this.clearConfigListener(),this.setState({downvoting:e,choosingCategory:!1})}clearConfigListener(){this.configListener&&(s.default.configListeners.splice(s.default.configListeners.indexOf(this.configListener),1),this.configListener=null)}openCategoryChooser(){this.configListener=()=>this.forceUpdate(),s.default.configListeners.push(this.configListener),this.setState({choosingCategory:!0,downvoting:!1},()=>{this.segments.length>1&&this.prepAction(l.CategoryVote)})}getCategoryOptions(){const e=[];for(const t of i.categoryList)e.push(o.createElement("option",{value:t,key:t},chrome.i18n.getMessage("category_"+t)));return e}unskip(e){this.contentContainer().unskipSponsorTime(this.segments[e]),this.unskippedMode(e,chrome.i18n.getMessage("reskip"))}unskippedMode(e,t){this.setState(this.getUnskippedModeInfo(e,t),()=>{this.noticeRef.current.resetCountdown()})}getUnskippedModeInfo(e,t){const n=()=>{const t=this.segments[e],n=Math.round((t.segment[1]-this.contentContainer().v.currentTime)*(1/this.contentContainer().v.playbackRate));return Math.max(n,s.default.config.skipNoticeDuration)};return{unskipText:t,unskipCallback:e=>this.reskip(e),maxCountdownTime:n,countdownTime:n()}}reskip(e){this.contentContainer().reskipSponsorTime(this.segments[e]);const t={unskipText:chrome.i18n.getMessage("unskip"),unskipCallback:this.unskip.bind(this),maxCountdownTime:()=>s.default.config.skipNoticeDuration,countdownTime:s.default.config.skipNoticeDuration};this.autoSkip||(t.noticeTitle=chrome.i18n.getMessage("noticeTitle")),this.setState(t,()=>{this.noticeRef.current.resetCountdown()})}afterVote(e,t,n){this.addVoteButtonInfo(chrome.i18n.getMessage("voted")),0===t&&(this.setNoticeInfoMessage(chrome.i18n.getMessage("hitGoBack")),this.adjustDownvotingState(!1)),e&&(0===t?e.hidden=r.SponsorHideType.Downvoted:n&&(e.category=n),this.contentContainer().updatePreviewBar())}setNoticeInfoMessageWithOnClick(e,...t){this.setState({messages:t,messageOnClick:t=>e(t)})}setNoticeInfoMessage(...e){this.setState({messages:e})}addVoteButtonInfo(e){this.setState({thanksForVotingText:e})}resetVoteButtonInfo(){this.setState({thanksForVotingText:null})}closeListener(){this.clearConfigListener(),this.props.closeListener()}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),i=n(5),s=new(n(2).default),r=n(20);t.default=class{constructor(e,t){this.noticeRef=o.createRef(),this.contentContainer=e,this.callback=t;const n=s.findReferenceNode();this.noticeElement=document.createElement("div"),this.noticeElement.id="submissionNoticeContainer",n.prepend(this.noticeElement),i.render(o.createElement(r.default,{contentContainer:e,callback:t,ref:this.noticeRef,closeListener:()=>this.close()}),this.noticeElement)}update(){this.noticeRef.current.forceUpdate()}close(){i.unmountComponentAtNode(this.noticeElement),this.noticeElement.remove()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),i=n(0),s=n(7),r=n(8),a=n(21);class c extends o.Component{constructor(e){super(e),this.noticeRef=o.createRef(),this.contentContainer=e.contentContainer,this.callback=e.callback;const t=chrome.i18n.getMessage("confirmNoticeTitle");this.state={noticeTitle:t,messages:[],idSuffix:"SubmissionNotice"}}componentDidMount(){this.videoObserver=new MutationObserver(()=>{this.forceUpdate()}),this.videoObserver.observe(this.contentContainer().v,{attributes:!0})}componentWillUnmount(){this.videoObserver&&this.videoObserver.disconnect()}render(){return o.createElement(s.default,{noticeTitle:this.state.noticeTitle,idSuffix:this.state.idSuffix,ref:this.noticeRef,closeListener:this.cancel.bind(this),zIndex:5e4},this.getMessageBoxes(),o.createElement("tr",{id:"sponsorSkipNoticeMiddleRow"+this.state.idSuffix,className:"sponsorTimeMessagesRow",style:{maxHeight:this.contentContainer().v.offsetHeight-200+"px"}},o.createElement("td",{style:{width:"100%"}},this.getSponsorTimeMessages())),o.createElement("tr",{id:"sponsorSkipNoticeSecondRow"+this.state.idSuffix},o.createElement("td",{className:"sponsorSkipNoticeRightSection",style:{position:"relative"}},o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:()=>window.open("https://github.com/ajayyy/SponsorBlock/wiki/Guidelines")},chrome.i18n.getMessage(i.default.config.submissionCountSinceCategories>3?"guidelines":"readTheGuidelines")),o.createElement("button",{className:"sponsorSkipObject sponsorSkipNoticeButton sponsorSkipNoticeRightButton",onClick:this.submit.bind(this)},chrome.i18n.getMessage("submit")))))}getSponsorTimeMessages(){const e=[];this.timeEditRefs=[];const t=this.props.contentContainer().sponsorTimesSubmitting;for(let n=0;n<t.length;n++){const t=o.createRef();e.push(o.createElement(a.default,{key:n,idSuffix:this.state.idSuffix+n,index:n,contentContainer:this.props.contentContainer,submissionNotice:this,ref:t})),this.timeEditRefs.push(t)}return e}getMessageBoxes(){const e=[];for(let t=0;t<this.state.messages.length;t++)e.push(o.createElement(r.default,{idSuffix:this.state.idSuffix+t,text:this.state.messages[t],key:t}));return e}cancel(){this.noticeRef.current.close(!0),this.contentContainer().resetSponsorSubmissionNotice(),this.props.closeListener()}submit(){var e,t,n;for(const e of this.timeEditRefs)e.current.saveEditTimes();const o=this.props.contentContainer().sponsorTimesSubmitting;for(const e of o)if("chooseACategory"===e.category)return void alert(chrome.i18n.getMessage("youMustSelectACategory"));if("Music"===(null===(n=null===(t=null===(e=this.contentContainer().videoInfo)||void 0===e?void 0:e.microformat)||void 0===t?void 0:t.playerMicroformatRenderer)||void 0===n?void 0:n.category))for(const e of o)if("sponsor"===e.category){if(!confirm(chrome.i18n.getMessage("nonMusicCategoryOnMusic")))return;break}this.props.callback(),this.cancel()}}t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),i=n(0),s=n(3),r=new(n(2).default);class a extends o.Component{constructor(e){super(e),this.categoryOptionRef=o.createRef(),this.idSuffix=this.props.idSuffix,this.state={editing:!1,sponsorTimeEdits:[null,null]}}componentDidMount(){document.getElementById("sponsorTimesContainer"+this.idSuffix).addEventListener("keydown",(function(e){e.stopPropagation()})),this.configUpdateListener||(this.configUpdateListener=()=>this.configUpdate(),i.default.configListeners.push(this.configUpdate.bind(this)))}componentWillUnmount(){this.configUpdateListener&&i.default.configListeners.splice(i.default.configListeners.indexOf(this.configUpdate.bind(this)),1)}render(){const e={textAlign:"center"};0!=this.props.index&&(e.marginTop="15px");const t=e=>{e&&(e.style.setProperty("color","black","important"),e.style.setProperty("text-shadow","none","important"))};let n;const i=this.props.contentContainer().sponsorTimesSubmitting[this.props.index],s=i.segment;return n=this.state.editing?o.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,className:"sponsorTimeDisplay"},o.createElement("span",{id:"nowButton0"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(0)},chrome.i18n.getMessage("bracketNow")),o.createElement("input",{id:"submittingTime0"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",ref:t,type:"text",value:this.state.sponsorTimeEdits[0],onChange:e=>{const t=this.state.sponsorTimeEdits;t[0]=e.target.value,this.setState({sponsorTimeEdits:t}),this.saveEditTimes()}}),o.createElement("span",null," "+chrome.i18n.getMessage("to")+" "),o.createElement("input",{id:"submittingTime1"+this.idSuffix,className:"sponsorTimeEdit sponsorTimeEditInput",ref:t,type:"text",value:this.state.sponsorTimeEdits[1],onChange:e=>{const t=this.state.sponsorTimeEdits;t[1]=e.target.value,this.setState({sponsorTimeEdits:t}),this.saveEditTimes()}}),o.createElement("span",{id:"nowButton1"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToNow(1)},chrome.i18n.getMessage("bracketNow")),o.createElement("span",{id:"endButton"+this.idSuffix,className:"sponsorNowButton",onClick:()=>this.setTimeToEnd()},chrome.i18n.getMessage("bracketEnd"))):o.createElement("div",{id:"sponsorTimesContainer"+this.idSuffix,className:"sponsorTimeDisplay",onClick:this.toggleEditTime.bind(this)},r.getFormattedTime(s[0],!0)+(isNaN(s[1])?"":" "+chrome.i18n.getMessage("to")+" "+r.getFormattedTime(s[1],!0))),o.createElement("div",{style:e},n,o.createElement("div",{style:{position:"relative"}},o.createElement("select",{id:"sponsorTimeCategories"+this.idSuffix,className:"sponsorTimeCategories",defaultValue:i.category,ref:this.categoryOptionRef,onChange:this.categorySelectionChange.bind(this)},this.getCategoryOptions()),o.createElement("img",{id:"sponsorTimeCategoriesHelpButton"+this.idSuffix,className:"helpButton",src:chrome.extension.getURL("icons/help.svg"),title:chrome.i18n.getMessage("categoryGuidelines"),onClick:()=>chrome.runtime.sendMessage({message:"openConfig"})})),o.createElement("br",null),o.createElement("span",{id:"sponsorTimeDeleteButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.deleteTime.bind(this)},chrome.i18n.getMessage("delete")),isNaN(s[1])?"":o.createElement("span",{id:"sponsorTimePreviewButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.previewTime.bind(this)},chrome.i18n.getMessage("preview")),isNaN(s[1])?"":o.createElement("span",{id:"sponsorTimeInspectButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.inspectTime.bind(this)},chrome.i18n.getMessage("inspect")),isNaN(s[1])?"":o.createElement("span",{id:"sponsorTimeEditButton"+this.idSuffix,className:"sponsorTimeEditButton",onClick:this.toggleEditTime.bind(this)},this.state.editing?chrome.i18n.getMessage("save"):chrome.i18n.getMessage("edit")))}getCategoryOptions(){const e=[o.createElement("option",{value:"chooseACategory",key:"chooseACategory"},chrome.i18n.getMessage("chooseACategory"))];for(const t of s.categoryList)e.push(o.createElement("option",{value:t,key:t},chrome.i18n.getMessage("category_"+t)));return e}categorySelectionChange(e){if(!i.default.config.categorySelections.some(t=>t.name===e.target.value)){const t=e.target.value;return e.target.value="chooseACategory",void(confirm(chrome.i18n.getMessage("enableThisCategoryFirst").replace("{0}",chrome.i18n.getMessage("category_"+t)))&&chrome.runtime.sendMessage({message:"openConfig"}))}this.saveEditTimes()}setTimeToNow(e){this.setTimeTo(e,this.props.contentContainer().getRealCurrentTime())}setTimeToEnd(){this.setTimeTo(1,this.props.contentContainer().v.duration)}setTimeTo(e,t){const n=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];n.segment[e]=t,this.setState({sponsorTimeEdits:this.getFormattedSponsorTimesEdits(n)},this.saveEditTimes)}toggleEditTime(){if(this.state.editing)this.setState({editing:!1}),this.saveEditTimes();else{const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index];this.setState({editing:!0,sponsorTimeEdits:this.getFormattedSponsorTimesEdits(e)})}}getFormattedSponsorTimesEdits(e){return[r.getFormattedTime(e.segment[0],!0),r.getFormattedTime(e.segment[1],!0)]}saveEditTimes(){const e=this.props.contentContainer().sponsorTimesSubmitting;if(this.state.editing){const t=r.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[0]),n=r.getFormattedTimeToSeconds(this.state.sponsorTimeEdits[1]);null!==t&&null!==n&&(e[this.props.index].segment=[t,n])}e[this.props.index].category=this.categoryOptionRef.current.value,i.default.config.segmentTimes.set(this.props.contentContainer().sponsorVideoID,e),this.props.contentContainer().updatePreviewBar()}previewTime(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index].segment[0];this.props.contentContainer().previewTime(e-2)}inspectTime(){const e=this.props.contentContainer().sponsorTimesSubmitting[this.props.index].segment[0];this.props.contentContainer().previewTime(e+1e-6,!1)}deleteTime(){const e=this.props.contentContainer().sponsorTimesSubmitting,t=this.props.index,n=e[t].segment.length<2;e.splice(t,1),i.default.config.segmentTimes.set(this.props.contentContainer().sponsorVideoID,e),this.props.contentContainer().updatePreviewBar(),0==e.length?this.props.submissionNotice.cancel():this.props.submissionNotice.forceUpdate(),(0===e.length||n)&&this.props.contentContainer().updateEditButtonsOnPlayer()}configUpdate(){this.forceUpdate()}}t.default=a}]);